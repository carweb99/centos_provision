- name: Ensure postfix is installed.
  package:
    name: [mailx, postfix]
    state: present

- name: Update Postfix configuration.
  lineinfile:
    dest: /etc/postfix/main.cf
    line: "{{ item.name }} = {{ item.value }}"
    regexp: "^{{ item.name }} ="
  with_items:
    - name: inet_interfaces
      value: localhost
    - name: inet_protocols
      value: ipv4
  notify: restart postfix

- name: Check if hostname contains only numbers
  set_fact:
    hostname_output: "{{ lookup('file', '/etc/hostname') }}"

- name: set domainname to localhost.localdomain
  lineinfile:
    path: /etc/selinux/config
    regexp: '^#myorigin'
    line: 'mydomain = localhost.localdomain'

- name: Ensure postfix is started and enabled at boot.
  service:
    name: postfix
    state: started
    enabled: true
